{% extends "base.html" %}

{% block content %}
    <h1>Your newsfeed</h1>
    <div class="row">
        <div class="column left">
            {% for post in posts %}
                <p>
                    {{ post.user }} says: <b>{{ post.postText }}</b>
                    
                    {% if comments %}
                        {% for comment in comments %}
                        <p>
                            {% if comment.postID == post.id %}
                                {{ comment.user }} commented: <i>{{ comment.commentText }}</i>
                            {% endif %}
                        </p>
                        {% endfor %}
                    {% else %}
                        <i>No comments on this post.</i>
                    {% endif %} 

                    <form action="http://localhost:5002/comment" method="POST">
                        <input type="hidden" name="postID" value={{ post.id }}>
                        {{ commentForm.hidden_tag() }}
                        <p>
                            {{ commentForm.commentText.label }}<br>
                            {{ commentForm.commentText(size=144) }}<br>
                          <!--   {% for error in commentForm.commentText.errors %}
                                <span style="color: red;">[{{ error }}]</span>
                            {% endfor %} -->
                        </p>
                        <p>{{ commentForm.submit() }}</p>
                    </form>
                    <hr>
                </p>
            {% endfor %}
        </div>

        <div class="column middle">
            {% if photos %}
                {% for photo in photos %}
                    {{ photo.user }}'s photo
                    <!-- <img src="{{ url_for('static', filename=photo.filename) }}" alt="{{ photo.filename }}"> -->
                    <img src="{{ photo }}" alt="{{ photo.filename }}">
                    <form action="http://localhost:5002/comment" method="POST">
                        <input type="hidden" name="postID" value={{ photo.id }}>
                        <input type="submit" name="addComment" value="Add Comment">
                    </form>

                    <i>No comments on this photo.</i>
                    <!-- {% if comments %}
                        {% for comment in comments %}
                        <p>
                            {% if comment.postID == photo.id %}
                                {{ comment.user }} commented: <i>{{ comment.commentText }}</i>
                            {% endif %}
                        </p>
                        {% endfor %}
                    {% else %}
                        <i>No comments on this photo.</i>
                    {% endif %} -->
                {% endfor %}
            {% else %}
                Place your photos here.
            {% endif %}
        </div>

        <div class="column right">
            {% if advertisements %}
                {% for advertisement in advertisements %}
                    <p>
                        {{advertisement.text}} For more check: <a href={{advertisement.source_url}}>Potatoes</a>
                    </p>

                    <img src="data:image/png;base64,{{advertisement.img}}" alt="Potatoes" height="50" width="50" />
            {% endfor %}
            {% else %}
                Place your advertisements here.
            {% endif %}
        </div>
    </div> 
{% endblock %}